"use strict";$(function(){function e(){G?M.pause():M.play(),M.onplaying=function(){G=!0},M.onpause=function(){G=!1}}function t(){n(),l(),g(),i()}function o(e){if($(e.target).hasClass("easyButton")){alert("Easy Mode Selected"),N++,x.text(N),O=1;for(var o=0;o<5;o++)y.append('<div class="square"></div>');t()}else if($(e.target).hasClass("hardButton")){alert("Hard Mode Selected"),N++,x.text(N),O=5;for(var n=0;n<9;n++)y.append('<div class="square"></div>');t()}}function n(){q.hide(),w.hide(),C.show(),I.show()}function r(){return colorPalette[Math.floor(Math.random()*colorPalette.length)]}function a(){var e=elementSelector[O-1];return P=e.map(function(e){return E[e]})}function l(){H=[],console.log("In play round",O),E=r(),a(),console.log("roundArray",P),P.shuffle(),console.log("shuffledArray",H),$(".square").each(function(e,t){$(t).css("backgroundColor",H[e])})}function u(e){var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return t&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):e}function s(){var e=[];$(".square").each(function(t,o){var n=$(o).css("backgroundColor");e.push(n)}),console.log("userRgb",e);var t=e.map(u);console.log("userSortedArray",t),console.log("roundArray",P),t.length===P.length&&t.every(function(e,t){return e===P[t]})?(console.log("It's a match, well done"),A.play(),console.log("roundCounter before alerts",N),N>4?(alert("Game complete"),d()):(alert("Round complete, press Next Round to continue."),S.show())):console.log("Not quite, have another go")}function i(e){var t=$(e.target).index(".square"),o=$(".square").length;0!==t&&t!==o-1&&(0===Y?(J=$(this),U=J.css("backgroundColor")):1===Y&&(J.css("backgroundColor",$(this).css("backgroundColor")),$(this).css("backgroundColor",U),Y=-1,s()),Y+=1)}function c(){N++,O++,y.append('<div class="square"></div>'),S.hide()}function f(){c(),x.text(N),l()}function h(){N=0,O=null,C.hide(),S.hide(),$(".square").remove(),I.hide(),q.show(),w.show();var e=[];console.log(e)}function d(){p(),v(),alert("Game Complete! You finished with a time of "+T),m(),h()}function g(){D=new Date}function p(){R=new Date}function v(){T=(R-D)/1e3}function m(){return T<j?alert("Congratulations, you've set the new quickest time!"):alert("Unfortunately, you weren't quite fast enought to set a new quick time."),j=T<j?T:j,localStorage.setItem("quickestTime",j),j}console.log("Igor, JavaScript' alive!");var y=$(".gameBoard"),k=$(".difficulty"),q=$(".easyButton"),w=$(".hardButton"),C=$(".resetButton"),S=$(".nextButton"),b=$(".quickTime"),I=$(".roundDisplay"),x=$(".round"),B=$(".soundOnOff"),A=$("audio")[0],M=$("audio")[1],D=null,R=null,T=null,G=!1,N=0,O=null,P=null,E=null,H=[],J=void 0,U=null,Y=0,j=localStorage.getItem("quickestTime")||45;b.text(j),B.on("click",e),y.on("click",".square",i),S.on("click",f),C.on("click",h),k.on("click",o),Array.prototype.shuffle=function(){for(var e=1;e<this.length-1;e++)H.push(this[e]);if(H.sort(function(){return.5-Math.random()}),H.push(this[this.length-1]),H.unshift(this[0]),H.length!==P.length||!H.every(function(e,t){return e===P[t]}))return H;H=[],P.shuffle()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiJGRpZmZpY3VsdHkiLCJpc1BsYXlpbmciLCIkYmFja2dyb3VuZFNvdW5kIiwicGF1c2UiLCJwbGF5Iiwib25wbGF5aW5nIiwicGxheUdhbWUiLCJnYW1lU3RhcnQiLCJwbGF5Um91bmQiLCJzdGFydFRpbWUiLCJjaG9vc2VSb3VuZCIsImUiLCJ0YXJnZXQiLCJoYXNDbGFzcyIsImFsZXJ0Iiwicm91bmRDb3VudGVyIiwiJHJvdW5kIiwidGV4dCIsInJvdW5kTnVtYmVyIiwiJGdhbWVCb2FyZCIsIiRlYXN5QnV0dG9uIiwiaGlkZSIsIiRoYXJkQnV0dG9uIiwiY29sb3JzIiwiY29sb3JQYWxldHRlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwic2VxdWVuY2VNYXRjaGVyIiwic2VxdWVuY2VBcnJheSIsImVsZW1lbnRTZWxlY3RvciIsIm1hcCIsIml0ZW0iLCJzaHVmZmxlZEFycmF5IiwiY29uc29sZSIsImxvZyIsInJhbmRvbUNvbG9yc0FyciIsInNodWZmbGUiLCJlYWNoIiwicm91bmRBcnJheSIsImlkeCIsInJnYlRvSGV4IiwidXNlclJnYiIsInJnYiIsInJlcGxhY2UiLCJtYXRjaCIsInBhcnNlSW50IiwidG9TdHJpbmciLCJzbGljZSIsImNoZWNrQ29tcGxldGUiLCJpbmRleCIsImVsZW1lbnQiLCJiYWNrZ3JvdW5kQ29sb3VyIiwidXNlclNvcnRlZEFycmF5IiwiZXZlcnkiLCJ2IiwiaSIsIiRwaW5nU291bmQiLCJlbmRHYW1lIiwiY2hhbmdlQ29sb3IiLCJwcmV2Y29sb3IiLCJwcmV2IiwiY3NzIiwidGhpcyIsImNvdW50IiwibmV4dFJvdW5kIiwic3RhcnRSb3VuZCIsInJlc2V0R2FtZSIsIiRyZXNldEJ1dHRvbiIsIiRuZXh0QnV0dG9uIiwic2hvdyIsIiR3aGljaFJvdW5kIiwiZW5kVGltZSIsInRpbWVEaWZmIiwidGltZTEiLCJEYXRlIiwidGltZTIiLCJ1c2VyVGltZSIsInVwZGF0ZVRpbWUiLCJxdWlja2VzdFRpbWUiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiJHF1aWNrVGltZSIsIiRzb3VuZCIsImdldEl0ZW0iLCJvbiIsInRvZ2dsZVBsYXlQYXVzZSIsIkFycmF5IiwicHJvdG90eXBlIiwicHVzaCIsInVuc2hpZnQiXSwibWFwcGluZ3MiOiJZQUNBQSxHQUFBLFdBOENFQyxRQUFBQSxLQUNBQyxFQUlJQyxFQUFpQkMsUUFEbkJELEVBQWVFLE9BR2JGLEVBQUFBLFVBQUEsV0FDREQsR0FBQSxHQUVEQyxFQUFpQkcsUUFBakIsV0FDRUosR0FBWSxHQUtmLFFBQUFLLEtBQ0RDLElBSUVDLElBRkZDLElBQ0VGLElBSUQsUUFBQUcsR0FBQUMsR0FDRCxHQUFBWixFQUFBWSxFQUFBQyxRQUFBQyxTQUFBLGNBQUEsQ0FJSUMsTUFBTSxzQkFGVkMsSUFDRUMsRUFBUUosS0FBSkcsR0FDRkQsRUFBTSxDQUNOQyxLQUFBQSxHQUFBQSxHQUFBQSxFQUFBQSxFQUFBQSxFQUFBQSxJQUNBQyxFQUFZRCxPQUFBQSw2QkFFWlQsU0FFQyxJQUFBUCxFQUFBWSxFQUFBQyxRQUFBQyxTQUFBLGNBQUEsQ0FDRFAsTUFBQUEsc0JBUkZTLElBV0VELEVBQU1HLEtBQUFGLEdBQ05BLEVBQUFBLENBQ0FDLEtBQUFBLEdBQU9DLEdBQUtGLEVBQUFBLEVBQUFBLEVBQUFBLElBQ1pHLEVBQUFBLE9BQUEsNkJBRUVDLE1BS04sUUFBQVosS0FHRWEsRUFBWUMsT0FEZEMsRUFBU2YsT0FDUGEsRUFBWUMsT0FDWkMsRUFBWUQsT0FJZCxRQUFBRSxLQUdFLE1BQU9DLGNBQWFDLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVNILGFBQWFJLFNBRTVELFFBQUFDLEtBR0UsR0FBTUMsR0FBZ0JDLGdCQUFnQmIsRUFBWSxFQURwRCxPQUFTVyxHQUFBQSxFQUFrQkcsSUFBQSxTQUFBQyxHQUN6QixNQUFNSCxHQUFnQkMsS0FzQnJCLFFBQUF2QixLQWZIMEIsS0FzQkVDLFFBQVFDLElBQUksZ0JBQWlCbEIsR0FIL0JtQixFQUFBZCxJQUNFVyxJQUNBaEIsUUFBQUEsSUFBQUEsYUFBQUEsR0FDQWlCLEVBQUFHLFVBQ0FELFFBQUFBLElBQUFBLGdCQUFBSCxHQUVBQyxFQUFBQSxXQUFZSSxLQUFBLFNBQWNDLEVBQUFBLEdBQzFCQSxFQUFBQSxHQUFBQSxJQUFXRixrQkFBWEosRUFBQU8sTUFLQyxRQUZEQyxHQUFBQyxHQUdELEdBQUFDLEdBQUFELEVBQUFFLFFBQUEsTUFBQSxJQUFBQyxNQUFBLDZCQUNELE9BQUFGLElBQUEsSUFBQUEsRUFBQWhCLE9BQUEsS0FLRyxJQUFNbUIsU0FBU0gsRUFBSSxHQUFHLElBQUlJLFNBQVMsS0FBS0MsT0FBTyxJQUhsRCxJQUFTUCxTQUFVQyxFQUFBQSxHQUFuQixJQUE0QkssU0FBQSxLQUFBQyxPQUFBLElBQzFCLElBQUlMLFNBQU1ELEVBQVFFLEdBQUFBLElBQVFHLFNBQWhCLEtBQTBCRixPQUFNLEdBQUFILEVBUTVDLFFBQVNPLEtBQVQsR0FBQVAsS0FDRTVDLEdBQUEsV0FBTTRDLEtBQU4sU0FBQVEsRUFBQUMsR0FDRSxHQUFBQyxHQUFnQnRELEVBQVNvRCxHQUFPQyxJQUFoQixrQkFDaEJULEdBQU1VLEtBQUFBLEtBRVBsQixRQUhEQyxJQUFBLFVBQUFPLEVBTUEsSUFBTVcsR0FBa0JYLEVBQVFYLElBQUlVLEVBQXBDUCxTQUFNbUIsSUFBQUEsa0JBQTBCdEIsR0FDaENHLFFBQVFDLElBQUksYUFBQUksR0FHUmMsRUFBZ0IxQixTQUFXWSxFQUFXWixRQUFVMEIsRUFBZ0JDLE1BQU0sU0FBQ0MsRUFBRUMsR0FBSCxNQUFRRCxLQUFNaEIsRUFBV2lCLE1BQW5HdEIsUUFBSW1CLElBQUFBLDJCQUFzRUksRUFBUUYsT0FDaEZyQixRQUFRQyxJQUFJLDZCQUFackIsR0FDQTJDLEVBQUEsR0FJRTVDLE1BQU0saUJBRlJxQixNQUVFckIsTUFBTSxpREFDTjZDLEVBQUFBLFNBSUR4QixRQUFBQyxJQUFBLDhCQU1MLFFBQUF3QixHQUFBakQsR0FHRSxHQUFNd0MsR0FBUXBELEVBQUVZLEVBQUVDLFFBQVF1QyxNQUFNLFdBRGxDdkIsRUFBU2dDLEVBQUFBLFdBQWNoQyxNQUNQN0IsS0FBZG9ELEdBQWtCdkMsSUFBSmdCLEVBQWtCLElBQ2YsSUFBWEEsR0FDSHVCLEVBQUFBLEVBQUFBLE1BQ0RVLEVBQWFDLEVBQUVDLElBQUEsb0JBQ2IsSUFBT2hFLElBQ1A4RCxFQUFBQSxJQUFBQSxrQkFBcUI5RCxFQUFBaUUsTUFBQUQsSUFBckIsb0JBRkZoRSxFQUFBaUUsTUFHTUQsSUFBR0Usa0JBQVlKLEdBQ25CQyxHQUFTLEVBQ1QvRCxLQUVBbUQsR0FBQUEsR0FLTixRQUFBZ0IsS0FHRW5ELElBREZHLElBQ0VILEVBQUFBLE9BQUFBLDhCQUNBRyxFQUFBQSxPQUlGLFFBQUFpRCxLQUdFRCxJQURGbEQsRUFBU21ELEtBQUFBLEdBQ1BELElBSUYsUUFBQUUsS0FHRXJELEVBQWUsRUFEakJHLEVBQVNrRCxLQUNQckQsRUFBQUEsT0FDQUcsRUFBQUEsT0FDQW1ELEVBQUFBLFdBQWFoRCxTQUNiaUQsRUFBWWpELE9BQ1p0QixFQUFBd0UsT0FDQUMsRUFBWW5ELE1BQ1pELElBRUlvQixLQUNKTCxTQUFJRSxJQUFBQSxHQUlOLFFBQUFzQixLQUdFYyxJQURGQyxJQUNFRCxNQUFBQSw4Q0FBQUEsR0FDQUMsSUFDQTVELElBSUYsUUFBQUwsS0FHRWtFLEVBQVEsR0FBSUMsTUFFZCxRQUFBSCxLQUdFSSxFQUFRLEdBQUlELE1BRWQsUUFBQUYsS0FHRUksR0FBWUQsRUFBUUYsR0FBTyxJQUUzQixRQUFBSSxLQVNBQyxNQVBGRixHQUFTQyxFQUNQakUsTUFBQUEsc0RBRUVBLE1BQUFBLDBFQUVBQSxFQUFBQSxFQUFBQSxFQUFBQSxFQUFBQSxFQUNEbUUsYUFBQUMsUUFBQSxlQUFBRixHQUNEQSxFQS9RRjdDLFFBQUFDLElBQU0sMkJBRU5ELElBQUFBLEdBQVlwQyxFQUFBLGNBR05DLEVBQWNELEVBQUUsZUFEaEJvQixFQUFlcEIsRUFBQSxlQUNmQyxFQUFnQkQsRUFBQSxlQUNoQnFCLEVBQWdCckIsRUFBQSxnQkFDaEJ1QixFQUFnQnZCLEVBQUEsZUFDaEJzRSxFQUFldEUsRUFBRSxjQUNqQnVFLEVBQWdCdkUsRUFBQSxpQkFDaEJvRixFQUFBQSxFQUFhcEYsVUFDYnlFLEVBQUFBLEVBQUFBLGVBQ0F4RCxFQUFXakIsRUFBQSxTQUFqQixHQUNNcUYsRUFBV3JGLEVBQUEsU0FBakIsR0FDTTJELEVBQUFBLEtBQ0F4RCxFQUFBQSxLQUNGeUUsRUFBUSxLQUVSRyxHQUFXLEVBR1gvRCxFQUFlLEVBRGZkLEVBQVksS0FDWmMsRUFBQUEsS0FDQUcsRUFBSixLQUNJc0IsS0FDQUgsTUFBQUEsR0FBQUEsRUFBa0IsS0FDbEJILEVBQUFBLEVBQ0E0QixFQUFKbUIsYUFBQUksUUFBQSxpQkFBQSxFQUNBRixHQUFJbEIsS0FBSmUsR0FLQUksRUFBT0UsR0FBRyxRQUFTQyxHQUFuQkgsRUFBVUUsR0FBQSxRQUFTQyxVQUFuQjNCLEdBR0F6QyxFQUFXbUUsR0FBRyxRQUFTbkIsR0FHdkJHLEVBQVlnQixHQUFHLFFBQVNuQixHQUd4QkUsRUFBQUEsR0FBQSxRQUFBM0QsR0F5RUE4RSxNQUFBQyxVQUFBbkQsUUFBQSxXQUdFLElBQUksR0FBSW1CLEdBQUUsRUFBR0EsRUFBRU8sS0FBS3BDLE9BQU8sRUFBRzZCLElBRGhDK0IsRUFBZ0JsRCxLQUFoQjBCLEtBQTBCUCxHQVF4QnZCLElBTkVBLEVBQUFBLEtBQWN3RCxXQUNmLE1BQUEsR0FBQWpFLEtBQUFFLFdBRUNPLEVBQU93RCxLQUFNakUsS0FBS0UsS0FBbEJDLE9BQUEsSUFDRE0sRUFGRHlELFFBQUEzQixLQUFBLElBSUE5QixFQUFjeUQsU0FBZG5ELEVBQUFaLFNBQUFNLEVBQUFxQixNQUFBLFNBQUFDLEVBQUFDLEdBQUEsTUFBQUQsS0FBQWhCLEVBQUFpQixLQUVBLE1BQW9HdkIsRUFDbEdBLE1BREZNLEVBQUlOIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb2xvclBhbGV0dGUgKi9cbi8qIGdsb2JhbCBlbGVtZW50U2VsZWN0b3IgKi9cblxuJCgoKSA9PiB7XG5cbiAgY29uc29sZS5sb2coJ0lnb3IsIEphdmFTY3JpcHRcXCcgYWxpdmUhJyk7XG5cbiAgY29uc3QgJGdhbWVCb2FyZCA9ICQoJy5nYW1lQm9hcmQnKTtcbiAgY29uc3QgJGRpZmZpY3VsdHkgPSAkKCcuZGlmZmljdWx0eScpO1xuICBjb25zdCAkZWFzeUJ1dHRvbiA9ICQoJy5lYXN5QnV0dG9uJyk7XG4gIGNvbnN0ICRoYXJkQnV0dG9uID0gJCgnLmhhcmRCdXR0b24nKTtcbiAgY29uc3QgJHJlc2V0QnV0dG9uID0gJCgnLnJlc2V0QnV0dG9uJyk7XG4gIGNvbnN0ICRuZXh0QnV0dG9uID0gJCgnLm5leHRCdXR0b24nKTtcbiAgY29uc3QgJHF1aWNrVGltZSA9ICQoJy5xdWlja1RpbWUnKTtcbiAgY29uc3QgJHdoaWNoUm91bmQgPSAkKCcucm91bmREaXNwbGF5Jyk7XG4gIGNvbnN0ICRyb3VuZCA9ICQoJy5yb3VuZCcpO1xuICBjb25zdCAkc291bmQgPSAkKCcuc291bmRPbk9mZicpO1xuICBjb25zdCAkcGluZ1NvdW5kID0gJCgnYXVkaW8nKVswXTtcbiAgY29uc3QgJGJhY2tncm91bmRTb3VuZCA9ICQoJ2F1ZGlvJylbMV07XG4gIGxldCB0aW1lMSA9IG51bGw7XG4gIGxldCB0aW1lMiA9IG51bGw7XG4gIGxldCB1c2VyVGltZSA9IG51bGw7XG5cbiAgbGV0IGlzUGxheWluZyA9IGZhbHNlO1xuICBsZXQgcm91bmRDb3VudGVyID0gMDtcbiAgbGV0IHJvdW5kTnVtYmVyID0gbnVsbDtcbiAgbGV0IHJvdW5kQXJyYXkgPSBudWxsO1xuICBsZXQgcmFuZG9tQ29sb3JzQXJyID0gbnVsbDtcbiAgbGV0IHNodWZmbGVkQXJyYXkgPSBbXTtcbiAgbGV0IHByZXYsIHByZXZjb2xvciA9IG51bGw7XG4gIGxldCBjb3VudCA9IDA7XG4gIGxldCBxdWlja2VzdFRpbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncXVpY2tlc3RUaW1lJykgfHwgNDU7XG5cbiAgJHF1aWNrVGltZS50ZXh0KHF1aWNrZXN0VGltZSk7XG5cbiAgJHNvdW5kLm9uKCdjbGljaycsIHRvZ2dsZVBsYXlQYXVzZSk7XG4gIC8vIEV2ZW50IExpc3RlbmVyIHVzZWQgdG8gcGxheSBhbmQgcGF1c2UgdGhlIGJhY2tncm91bmQgbXVzaWMgb2YgdGhlIGdhbWUuXG5cbiAgJGdhbWVCb2FyZC5vbignY2xpY2snLCAnLnNxdWFyZScsIGNoYW5nZUNvbG9yKTtcbiAgLy8gRXZlbnQgTGlzdGVuZXIgdXNlZCB3aXRoIHRoZSBjaGFuZ2VDb2xvciBmdW5jdGlvbiB0byBhbGxvdyBKUyB0byBsaXN0ZW4gZm9yIGNsaWNrcyBvbiB0aGUgc3F1YXJlcyBhbmQgY2hhbmdlIHRoZSBjb2xvdXJzIG9uY2UgdHdvIGNsaWNrcyBoYXZlIGJlZW4gcHJlc3NlZC5cblxuICAkbmV4dEJ1dHRvbi5vbignY2xpY2snLCBzdGFydFJvdW5kKTtcbiAgLy8gRXZlbnQgTGlzdGVuZXIgdXNlZCB0byBpbml0aWF0ZSB0aGUgbmV4dCByb3VuZCBvZiB0aGUgZ2FtZS4gRW1wdGllcyB0aGUgc2h1ZmZsZWRBcnJheSwgcnVucyB0aGUgZnVuY3Rpb24gbmV4dFJvdW5kLCBpbmNyZWFzZSB0aGUgcm91bmQgY291bnRlciBhbmQgcmVwb3B1bGF0ZXMgdGhlIG5leHQgcm91bmQgd2l0aCBhbiBhcnJheS5cblxuICAkcmVzZXRCdXR0b24ub24oJ2NsaWNrJywgcmVzZXRHYW1lKTtcbiAgLy8gRXZlbnQgTGlzdGVuZXIgdXNlZCB0byByZXNldCB0aGUgZ2FtZS4gQnJpbmdzIHRoZSBnYW1lIGJhY2sgdG8gdGhlIGluaXRpYWwgc3RhdGUgd2hlbiBsb2FkZWQuIERvZXMgdGhpcyBieSBydW5uaW5nIHRoZSByZXNldEdhbWUgZnVuY3Rpb24uXG5cbiAgJGRpZmZpY3VsdHkub24oJ2NsaWNrJywgY2hvb3NlUm91bmQpO1xuICAvLyBFdmVudCBMaXN0ZW5lciB1c2VkIHRvIHN0YXJ0IHRoZSBnYW1lLiBEZXBlbmRpbmcgb24gd2hpY2ggZ2FtZSBtb2RlIGlzIGNsaWNrZWQsIGl0IHJ1bnMgdGhlIHNjcmlwdCBmb3IgZWl0aGVyIGVhc3kgb3IgaGFyZC5cblxuICBmdW5jdGlvbiB0b2dnbGVQbGF5UGF1c2UgKCkge1xuICAgIGlmIChpc1BsYXlpbmcpIHtcbiAgICAgICRiYWNrZ3JvdW5kU291bmQucGF1c2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGJhY2tncm91bmRTb3VuZC5wbGF5KCk7XG4gICAgfVxuXG4gICAgJGJhY2tncm91bmRTb3VuZC5vbnBsYXlpbmcgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlzUGxheWluZyA9IHRydWU7XG4gICAgfTtcbiAgICAkYmFja2dyb3VuZFNvdW5kLm9ucGF1c2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlzUGxheWluZyA9IGZhbHNlO1xuICAgIH07XG4gIH1cbiAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHRvZ2dsZSB0aGUgYmFja2dyb3VuZCBtdXNpYyBvZiB0aGUgZ2FtZSBhbmQgaXMgaW52b2tlZCBieSB0aGUgRXZlbnQgTGlzdGVuZXIuXG5cbiAgZnVuY3Rpb24gcGxheUdhbWUgKCkge1xuICAgIGdhbWVTdGFydCgpO1xuICAgIHBsYXlSb3VuZCgpO1xuICAgIHN0YXJ0VGltZSgpO1xuICAgIGNoYW5nZUNvbG9yKCk7XG4gIH1cbiAgLy8gVGhpcyBmdW5jdGlvbiBjb21iaW5lcyB0aGUgZ2FtZVN0YXJ0LCBwbGF5Um91bmQsIHN0YXJ0VGltZSBhbmQgY2hhbmdlQ29sb3IgZnVuY3Rpb25zLlxuXG4gIGZ1bmN0aW9uIGNob29zZVJvdW5kIChlKSB7XG4gICAgaWYgKCQoZS50YXJnZXQpLmhhc0NsYXNzKCdlYXN5QnV0dG9uJykpIHtcbiAgICAgIGFsZXJ0KCdFYXN5IE1vZGUgU2VsZWN0ZWQnKTtcbiAgICAgIHJvdW5kQ291bnRlcisrO1xuICAgICAgJHJvdW5kLnRleHQocm91bmRDb3VudGVyKTtcbiAgICAgIHJvdW5kTnVtYmVyID0gMTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgICRnYW1lQm9hcmQuYXBwZW5kKCc8ZGl2IGNsYXNzPVwic3F1YXJlXCI+PC9kaXY+Jyk7XG4gICAgICB9XG4gICAgICBwbGF5R2FtZSgpO1xuXG4gICAgfSBlbHNlIGlmICgkKGUudGFyZ2V0KS5oYXNDbGFzcygnaGFyZEJ1dHRvbicpKSB7XG4gICAgICBhbGVydCgnSGFyZCBNb2RlIFNlbGVjdGVkJyk7XG4gICAgICByb3VuZENvdW50ZXIrKztcbiAgICAgICRyb3VuZC50ZXh0KHJvdW5kQ291bnRlcik7XG4gICAgICByb3VuZE51bWJlciA9IDU7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDk7IGkrKykge1xuICAgICAgICAkZ2FtZUJvYXJkLmFwcGVuZCgnPGRpdiBjbGFzcz1cInNxdWFyZVwiPjwvZGl2PicpO1xuICAgICAgfVxuICAgICAgcGxheUdhbWUoKTtcbiAgICB9XG4gIH1cbiAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHdoZW4gdGhlIHVzZXIgaXMgZGV0ZXJtaW5pbmcgd2hpY2ggZ2FtZSBtb2RlIHRoZXkgd2FudCB0byBwbGF5LlxuXG4gIGZ1bmN0aW9uIGdhbWVTdGFydCAoKSB7XG4gICAgJGVhc3lCdXR0b24uaGlkZSgpO1xuICAgICRoYXJkQnV0dG9uLmhpZGUoKTtcbiAgICAkcmVzZXRCdXR0b24uc2hvdygpO1xuICAgICR3aGljaFJvdW5kLnNob3coKTtcbiAgfVxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gc3RhcnQgdGhlIGdhbWUuIEl0IGhpZGVzIHRoZSBkaWZmaWN1bHR5IGJ1dHRvbnMgYW5kIHNob3dzIHRoZSBnYW1lIHNxdWFyZXMgYW5kIHJlc2V0IGJ1dHRvbi5cblxuICBmdW5jdGlvbiBjb2xvcnMoKSB7XG4gICAgcmV0dXJuIGNvbG9yUGFsZXR0ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqY29sb3JQYWxldHRlLmxlbmd0aCldO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gcmFuZG9tYWx5IGNob29zZXMgb25lIG9mIHRoZSAzMCBjb2xvciBwYWxldHRlcyBmb3IgdXNlIGluIGVhY2ggcm91bmQuXG5cbiAgZnVuY3Rpb24gc2VxdWVuY2VNYXRjaGVyKCkge1xuICAgIGNvbnN0IHNlcXVlbmNlQXJyYXkgPSBlbGVtZW50U2VsZWN0b3Jbcm91bmROdW1iZXItMV07XG4gICAgcmV0dXJuIHJvdW5kQXJyYXkgPSBzZXF1ZW5jZUFycmF5Lm1hcChmdW5jdGlvbihpdGVtKSB7XG4gICAgICByZXR1cm4gcmFuZG9tQ29sb3JzQXJyW2l0ZW1dO1xuICAgIH0pO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gdXNlcyB0aGUgcm91bmROdW1iZXIsIG1pbnVzIG9uZSwgdG8gZmluZCB0aGUgYXJyYXkgaW4gdGhlIGVsZW1lbnRTZWxlY3RvciBhbmQgbWFwcyBqdXN0IHRoZSBpbmRpY2VzIGZyb20gdGhhdCBhcnJheSBvbnRvIHRoZSByYW5kb20gYXJyYXkgY2hvc2VuIGZyb20gdGhlIGNvbG9ycyBmdW5jdGlvbiBhbmQgY2FsbHMgaXQgcm91bmRBcnJheSBhcyBpdCB3aWxsIGJlIHRoZSBhcnJheSB0aGF0IHRoZSB1c2VyIG5lZWRzIHRvIG1hdGNoLlxuXG4gIEFycmF5LnByb3RvdHlwZS5zaHVmZmxlID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yKGxldCBpPTE7IGk8dGhpcy5sZW5ndGgtMTsgaSsrKSB7XG4gICAgICBzaHVmZmxlZEFycmF5LnB1c2godGhpc1tpXSk7XG4gICAgfVxuICAgIHNodWZmbGVkQXJyYXkuc29ydChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAwLjUgLSBNYXRoLnJhbmRvbSgpO1xuICAgIH0pO1xuICAgIHNodWZmbGVkQXJyYXkucHVzaCh0aGlzW3RoaXMubGVuZ3RoLTFdKTtcbiAgICBzaHVmZmxlZEFycmF5LnVuc2hpZnQodGhpc1swXSk7XG5cbiAgICBpZiAoc2h1ZmZsZWRBcnJheS5sZW5ndGggPT09IHJvdW5kQXJyYXkubGVuZ3RoICYmIHNodWZmbGVkQXJyYXkuZXZlcnkoKHYsaSk9PiB2ID09PSByb3VuZEFycmF5W2ldKSkge1xuICAgICAgc2h1ZmZsZWRBcnJheSA9IFtdO1xuICAgICAgcm91bmRBcnJheS5zaHVmZmxlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzaHVmZmxlZEFycmF5O1xuICAgIH1cbiAgfTtcbiAgLy8gVGhpcyB0YWtlcyB0aGUgcm91bmRBcnJheSwgcmVtb3ZlcyB0aGUgZmlyc3QgYW5kIGxhc3QgaW5kaWNlcywgYW5kIHRoZW4gc2h1ZmZsZXMgdGhlIG1pZGRsZSBpbmRpY2VzLCBiZWZvcmUgcmVhdHRhY2hpbmcgdGhlIGZpcnN0IGFuZCBsYXN0IGluZGljZXMuIEl0IGFsc28gaGF2ZSBhIGRvdWJsZSBzaHVmZmxlIGZ1bmN0aW9uIGluIGNhc2UgdGhlIGZpcnN0IGZ1bmN0aW9uIHJldHVybnMgdGhlIHNhbWUgYXJyYXkgYXMgdGhlIHJvdW5kQXJyYXkuIFN0b3JlcyB0aGUgYXJyYXkgaW50byBhIHZhcmlhYmxlIGNhbGxlZCBzaHVmZmxlZEFycmF5LlxuXG4gIGZ1bmN0aW9uIHBsYXlSb3VuZCgpIHtcbiAgICBzaHVmZmxlZEFycmF5ID0gW107XG4gICAgcm91bmROdW1iZXI7XG4gICAgY29uc29sZS5sb2coJ0luIHBsYXkgcm91bmQnLCByb3VuZE51bWJlcik7XG4gICAgcmFuZG9tQ29sb3JzQXJyID0gY29sb3JzKCk7XG4gICAgc2VxdWVuY2VNYXRjaGVyKCk7XG4gICAgY29uc29sZS5sb2coJ3JvdW5kQXJyYXknLCByb3VuZEFycmF5KTtcbiAgICByb3VuZEFycmF5LnNodWZmbGUoKTtcbiAgICBjb25zb2xlLmxvZygnc2h1ZmZsZWRBcnJheScsIHNodWZmbGVkQXJyYXkpO1xuXG4gICAgJCgnLnNxdWFyZScpLmVhY2goZnVuY3Rpb24oaWR4LCBlbCkge1xuICAgICAgJChlbCkuY3NzKCdiYWNrZ3JvdW5kQ29sb3InLCBzaHVmZmxlZEFycmF5W2lkeF0pO1xuICAgIH0pO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gY29tYmluZXMgdGhlIGZ1bmN0aW9ucyBjb2xvcnMsIHNlcXVlbmNlTWF0Y2hlciBhbmQgc2h1ZmZsZS4gSXQgaXMgcnVuIGluIGVhY2ggcm91bmQuIE92ZXJhbGwsIGl0IHBpY2tzIGEgcmFuZG9tIGFycmF5IGZyb20gdGhlIGNvbG9yUGFsZXR0ZSwgbWFwcyBpdCBhZ2FpbnN0IHRoZSBzZXF1ZW5jZU1hdGNoZXIgdG8gcHJvZHVjZSB0aGUgcm91bmRBcnJheSwgd2hpY2ggaXMgdGhlbiBzaHVmZmxlZCB0byBwcm9kdWNlIHRoZSBzaHVmZmxlZEFycmF5LiBJdCB0aGVuIHB1c2hlcyB0aGUgSEVYIGNvbG9ycyBmcm9tIHRoZSBzaHVmZmxlZEFycmF5IGludG8gdGhlIGVtcHR5IGRpdnMgaW4gdGhlIEhUTUwuXG5cbiAgZnVuY3Rpb24gcmdiVG9IZXggKHVzZXJSZ2IpIHtcbiAgICB2YXIgcmdiID0gdXNlclJnYi5yZXBsYWNlKC9cXHMvZywnJykubWF0Y2goL15yZ2JhP1xcKChcXGQrKSwoXFxkKyksKFxcZCspL2kpO1xuICAgIHJldHVybiAocmdiICYmIHJnYi5sZW5ndGggPT09IDQpID8gJyMnICtcbiAgICAoJzAnICsgcGFyc2VJbnQocmdiWzFdLDEwKS50b1N0cmluZygxNikpLnNsaWNlKC0yKSArXG4gICAgKCcwJyArIHBhcnNlSW50KHJnYlsyXSwxMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtMikgK1xuICAgICgnMCcgKyBwYXJzZUludChyZ2JbM10sMTApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpIDogdXNlclJnYjtcbiAgfVxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY29udmVydCB0aGUgdXNlclJnYiBhcnJheSB3aGljaCBpcyByZXR1cm5lZCBhZnRlciB0d28gY2xpY2tzIGludG8gYW4gYXJyYXkgb2YgSEVYIGNvZGVzIHRvIGJlIGNvbXBhcmVkIGFnYWludCB0aGUgcm91bmRBcnJheS4gVGhlIGlucHV0IGZvcm1hdCBpcyBcInJnYihyLCBnLCBiLClcIiBhbmQgb3V0cHV0cyBcIiNIRVhDT0RFXCIuXG5cbiAgZnVuY3Rpb24gY2hlY2tDb21wbGV0ZSAoKSB7XG4gICAgY29uc3QgdXNlclJnYiA9IFtdO1xuICAgICQoJy5zcXVhcmUnKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICBjb25zdCBiYWNrZ3JvdW5kQ29sb3VyID0gJChlbGVtZW50KS5jc3MoJ2JhY2tncm91bmRDb2xvcicpO1xuICAgICAgdXNlclJnYi5wdXNoKGJhY2tncm91bmRDb2xvdXIpO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKCd1c2VyUmdiJywgdXNlclJnYik7XG5cbiAgICBjb25zdCB1c2VyU29ydGVkQXJyYXkgPSB1c2VyUmdiLm1hcChyZ2JUb0hleCk7XG4gICAgY29uc29sZS5sb2coJ3VzZXJTb3J0ZWRBcnJheScsIHVzZXJTb3J0ZWRBcnJheSk7XG4gICAgY29uc29sZS5sb2coJ3JvdW5kQXJyYXknLCByb3VuZEFycmF5KTtcblxuICAgIGlmICh1c2VyU29ydGVkQXJyYXkubGVuZ3RoID09PSByb3VuZEFycmF5Lmxlbmd0aCAmJiB1c2VyU29ydGVkQXJyYXkuZXZlcnkoKHYsaSk9PiB2ID09PSByb3VuZEFycmF5W2ldKSkge1xuICAgICAgY29uc29sZS5sb2coJ0l0XFwncyBhIG1hdGNoLCB3ZWxsIGRvbmUnKTtcbiAgICAgICRwaW5nU291bmQucGxheSgpO1xuXG4gICAgICBjb25zb2xlLmxvZygncm91bmRDb3VudGVyIGJlZm9yZSBhbGVydHMnLCByb3VuZENvdW50ZXIpO1xuICAgICAgaWYocm91bmRDb3VudGVyID4gNCkge1xuICAgICAgICBhbGVydCgnR2FtZSBjb21wbGV0ZScpO1xuICAgICAgICBlbmRHYW1lKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhbGVydCgnUm91bmQgY29tcGxldGUsIHByZXNzIE5leHQgUm91bmQgdG8gY29udGludWUuJyk7XG4gICAgICAgICRuZXh0QnV0dG9uLnNob3coKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnTm90IHF1aXRlLCBoYXZlIGFub3RoZXIgZ28nKTtcbiAgICB9XG4gIH1cbiAgLy8gVGhpcyBmdW5jdGlvbiBjaGVja3MgdG8gc2VlIGlmIHRoZSB1c2VyIGhhcyBzb3J0ZWQgdGhlIGFycmF5IHRoYXQgd2FzIHB1c2hlZCBpbnRvIHRoZSBkaXZzLiBJdCBiZWdpbnMgd2l0aCBhbiBlbXB0eSBhcnJheSwgdXNlclJnYiwgd2hpY2ggaXMgcG9wdWxhdGVkIHdpdGggdGhlIHJnYiBjb2RlcyBmcm9tIHRoZSBjb2xvcnMgdGhhdCBhcmUgY3VycmVudGx5IG9uIHZpZXcsIGluIHRoZSBvcmRlciB0aGV5IGFyZSBpbi4gSXQgdGhlbiBjb252ZXJ0cyB0aGUgcmdiIGNvbG9ycyBpbnRvIGhleCBjb2xvcnMgYW5kIHB1dHMgdGhlbSBpbnRvIGEgbmV3IGFycmF5IGNhbGxlZCB1c2VyU29ydGVkQXJyYXkuIEZpbmFsbHkgaXQgY29tcGFyZXMgdGhlIHVzZXJTb3J0ZWRBcnJheSB0byB0aGUgcm91bmRBcnJheSB0byBkZXRlcm1pbmUgaWYgdGhleSBhcmUgaWRlbnRpY2FsLiBJZiB0aGV5IGFyZSwgaXQgYWxlcnRzIHRoZSB1c2VyIHRoYXQgdGhlIG5leHQgcm91bmQgaXMgYXZhaWxhYmxlLiBPdGhlcndpc2UsIHRoZSB1c2VyIGNvbnRpbnVlcyB0byBzb3J0IHRoZSBhcnJheS5cblxuICBmdW5jdGlvbiBjaGFuZ2VDb2xvcihlKXtcbiAgICBjb25zdCBpbmRleCA9ICQoZS50YXJnZXQpLmluZGV4KCcuc3F1YXJlJyk7XG4gICAgY29uc3QgbGVuZ3RoID0gJCgnLnNxdWFyZScpLmxlbmd0aDtcbiAgICBpZihpbmRleCAhPT0gMCAmJiBpbmRleCAhPT0gKGxlbmd0aCAtIDEpKSB7XG4gICAgICBpZihjb3VudCA9PT0gMCl7XG4gICAgICAgIHByZXYgPSAkKHRoaXMpO1xuICAgICAgICBwcmV2Y29sb3IgPSBwcmV2LmNzcygnYmFja2dyb3VuZENvbG9yJyk7XG4gICAgICB9ZWxzZSBpZihjb3VudCA9PT0gMSl7XG4gICAgICAgIHByZXYuY3NzKCdiYWNrZ3JvdW5kQ29sb3InLCAkKHRoaXMpLmNzcygnYmFja2dyb3VuZENvbG9yJykpO1xuICAgICAgICAkKHRoaXMpLmNzcygnYmFja2dyb3VuZENvbG9yJywgcHJldmNvbG9yKTtcbiAgICAgICAgY291bnQgPSAtMTtcbiAgICAgICAgY2hlY2tDb21wbGV0ZSgpO1xuICAgICAgfVxuICAgICAgY291bnQrPTE7XG4gICAgfVxuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBzd2l0Y2ggdGhlIGNvbG9ycyB3aXRoaW4gZGl2LiBPbmx5IG9uY2UgdGhlIHVzZXIgaGFzIGNsaWNrZWQgb24gdHdvIHNlcGVyYXRlIGRpdnMgd2lsbCB0aGUgYmFja2dyb3VuZCBjb2xvcnMgY2hhbmdlLiBJdCBhbHNvIGluY2x1ZGVzIHRoZSBjaGVja0NvbXBsZXRlIGZ1bmN0aW9uIHNvIHRoYXQgb25jZSB0aGUgY2hhbmdlIGhhcyBiZWVuIG1hZGUsIGl0IGNhbiBjaGVjayB3aGV0aGVyIGl0IGlzIGNvcnJlY3Qgb3Igbm90LlxuXG4gIGZ1bmN0aW9uIG5leHRSb3VuZCAoKSB7XG4gICAgcm91bmRDb3VudGVyICsrO1xuICAgIHJvdW5kTnVtYmVyICsrO1xuICAgICRnYW1lQm9hcmQuYXBwZW5kKCc8ZGl2IGNsYXNzPVwic3F1YXJlXCI+PC9kaXY+Jyk7XG4gICAgJG5leHRCdXR0b24uaGlkZSgpO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB3aGVuIHRoZSBuZXh0QnV0dG9uIGlzIGNsaWNrZWQuIFRoZSBuZXh0QnV0dG9uIG9ubHkgYXBwZWFycyBhZnRlciB0aGUgdXNlciBoYXMgY29ycmVjdGx5IHNvcnRlZCB0aGUgYXJyYXksIGFuZCBpcyB1c2VkIHRvIG1vdmUgdG8gdGhlIG5leHQgcm91bmQuIEl0IGhpZGVzIG9uY2UgaXQgaXMgcHJlc3NlZCBzbyB0aGUgdXNlciBjYW5ub3Qgc2tpcCByb3VuZHMuXG5cbiAgZnVuY3Rpb24gc3RhcnRSb3VuZCAoKSB7XG4gICAgbmV4dFJvdW5kKCk7XG4gICAgJHJvdW5kLnRleHQocm91bmRDb3VudGVyKTtcbiAgICBwbGF5Um91bmQoKTtcbiAgfVxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgb24gdGhlIG5leHRSb3VuZCBFdmVudCBMaXN0ZW5lciB0byBiZWdpbiB0aGUgbmV4dCByb3VuZC5cblxuICBmdW5jdGlvbiByZXNldEdhbWUoKSB7XG4gICAgcm91bmRDb3VudGVyID0gMDtcbiAgICByb3VuZE51bWJlciA9IG51bGw7XG4gICAgJHJlc2V0QnV0dG9uLmhpZGUoKTtcbiAgICAkbmV4dEJ1dHRvbi5oaWRlKCk7XG4gICAgJCgnLnNxdWFyZScpLnJlbW92ZSgpO1xuICAgICR3aGljaFJvdW5kLmhpZGUoKTtcbiAgICAkZWFzeUJ1dHRvbi5zaG93KCk7XG4gICAgJGhhcmRCdXR0b24uc2hvdygpO1xuICAgIGxldCByb3VuZEFycmF5ID0gbnVsbDtcbiAgICBsZXQgcmFuZG9tQ29sb3JzQXJyID0gbnVsbDtcbiAgICBsZXQgc2h1ZmZsZWRBcnJheSA9IFtdO1xuICAgIGNvbnNvbGUubG9nKHNodWZmbGVkQXJyYXkpO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZXNldCB0aGUgZ2FtZS4gSXQgYnJpbmdzIHRoZSBnYW1lIGJhY2sgdG8gdGhlIG9yaWdpbmFsIHN0YXRlIGFuZCBzdG9wcyBhbnkgdGltZXJzIHRoYXQgbWlnaHQgaGF2ZSBiZWVuIHJ1bm5pbmcuXG5cbiAgZnVuY3Rpb24gZW5kR2FtZSAoKSB7XG4gICAgZW5kVGltZSgpO1xuICAgIHRpbWVEaWZmKCk7XG4gICAgYWxlcnQoYEdhbWUgQ29tcGxldGUhIFlvdSBmaW5pc2hlZCB3aXRoIGEgdGltZSBvZiAke3VzZXJUaW1lfWApO1xuICAgIHVwZGF0ZVRpbWUoKTtcbiAgICByZXNldEdhbWUoKTtcbiAgfVxuICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZW5kIHRoZSBnYW1lIHVwb24gY29tcGxldGlvbiBvZiB0aGUgZmlmdGggcm91bmQuIEl0IHRha2VzIGEgc2Vjb25kIHRpbWUsIGNvbnZlcnRzIGl0IHRvIHNlY29uZHMsIGFuZCB0aGVuIGFsZXJ0cyB0aGUgdXNlciB0byB0aGVpciBnYW1lIHRpbWUuIEl0IGFsc28gdXBkYXRlcyB0aGUgcXVpY2tlc3QgdGltZSBhbmQgYWxlcnRzIHRoZSB1c2VyIGlmIHRoZXkgc2V0IGEgbmV3IHF1aWNrZXN0IHRpbWUgb3Igbm90LiBGaW5hbGx5LCBpdCBicmluZ3MgdGhlIGdhbWUgYmFjayBpbnRvIHRoZSBzdGFydCBzdGF0ZS5cblxuICBmdW5jdGlvbiBzdGFydFRpbWUoKSB7XG4gICAgdGltZTEgPSBuZXcgRGF0ZSgpO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjYXB0dXJlIHRoZSB0aW1lIGF0IHdoaWNoIHRoZSB1c2VyIGJlZ2FuIHRoZSBnYW1lLlxuXG4gIGZ1bmN0aW9uIGVuZFRpbWUoKSB7XG4gICAgdGltZTIgPSBuZXcgRGF0ZSgpO1xuICB9XG4gIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjYXB0dXJlIHRoZSB0aW1lIGF0IHdoaWNoIHRoZSB1c2VyIGNvbXBsZXRlZCB0aGUgZ2FtZS5cblxuICBmdW5jdGlvbiB0aW1lRGlmZigpIHtcbiAgICB1c2VyVGltZSA9ICh0aW1lMiAtIHRpbWUxKS8xMDAwO1xuICB9XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHdvcmsgb3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHN0YXJ0IG9mIHRoZSBnYW1lIGFuZCB0aGUgZW5kIG9mIHRoZSBnYW1lIGFuZCBjb252ZXJ0IHRoZSB0aW1lIGludG8gc2Vjb25kcy5cblxuICBmdW5jdGlvbiB1cGRhdGVUaW1lICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhgJHtxdWlja2VzdFRpbWV9IGlzIHRoZSB0aW1lIHRvIGJlYXQgYnV0IHRoZSB1c2VyIGdvdCAke3VzZXJUaW1lfWApO1xuICAgIGlmICh1c2VyVGltZSA8IHF1aWNrZXN0VGltZSkge1xuICAgICAgYWxlcnQoYENvbmdyYXR1bGF0aW9ucywgeW91J3ZlIHNldCB0aGUgbmV3IHF1aWNrZXN0IHRpbWUhYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KGBVbmZvcnR1bmF0ZWx5LCB5b3Ugd2VyZW4ndCBxdWl0ZSBmYXN0IGVub3VnaHQgdG8gc2V0IGEgbmV3IHF1aWNrIHRpbWUuYCk7XG4gICAgfVxuICAgIHF1aWNrZXN0VGltZSA9ICh1c2VyVGltZSA8IHF1aWNrZXN0VGltZSkgPyB1c2VyVGltZSA6IHF1aWNrZXN0VGltZTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncXVpY2tlc3RUaW1lJywgcXVpY2tlc3RUaW1lKTtcbiAgICByZXR1cm4gcXVpY2tlc3RUaW1lO1xuICB9XG4gICAgLy8gVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGNoZWNrIHdoZXRoZXIgdGhlIGdhbWUgdGltZSBpcyBxdWlja2VyIHRoYW4gdGhlIGN1cnJlbnQgcXVpY2tlc3QgdGltZS4gSXQgYWxlcnRzIHRoZSB1c2VyIHdoZXRoZXIgdGhleSBoYXZlIHNldCBhIG5ldyBxdWljayB0aW1lIG9yIG5vdCwgYW5kIGlmIHRoZXJlIGlzIGEgbmV3IHF1aWNrIHRpbWUsIGl0IHVwZGF0ZXMgdGhlIGxvY2FsIHN0b3JhZ2Ugd2l0aCB0aGUgbmV3IHF1aWNrIHRpbWUuXG5cbn0pO1xuIl19
